{"version":3,"file":"circular-iframe-internal.js","sources":["../../js/circular-iframe-internal.js"],"sourcesContent":["\"use strict\";\n\n// Dynamic height for iframe circulars\n// - This script determines the height of the circular and pushes a message to the parent iframe.\n// - The parent iframe will adjust the height of the circular accordingly.\n// - The script will resend the message when the webpage is resized or when content is added to the page.\n\n(function() {\n  function calculateTrueHeight() {\n    const doc = document;\n    return Math.max(\n      Math.max(doc.body.scrollHeight, doc.documentElement.scrollHeight),\n      Math.max(doc.body.offsetHeight, doc.documentElement.offsetHeight),\n      Math.max(doc.body.clientHeight, doc.documentElement.clientHeight)\n    );\n  }\n\n  function sendHeightToParent(reason) {\n    const height = calculateTrueHeight();\n    console.log(`Sending height: ${height}, Reason: ${reason}`);\n    window.parent.postMessage({ type: 'resize-webstop-circular-iframe', height: height, reason: reason }, '*');\n  }\n\n  // Initial height calculation with a small delay\n  window.addEventListener('load', function() {\n    setTimeout(function() {\n      sendHeightToParent('load');\n    }, 50);\n  });\n\n  // Recalculate height on window resize\n  window.addEventListener('resize', function() {\n    setTimeout(function() {\n      sendHeightToParent('resize');\n    }, 50);\n  });\n\n  // Recalculate height on content changes\n  const observer = new MutationObserver(function(mutations) {\n    mutations.forEach(function(mutation) {\n      if (mutation.type === 'childList') {\n        setTimeout(function() {\n          sendHeightToParent('content-change');\n        }, 50);\n      }\n    });\n  });\n\n  observer.observe(document.body, { childList: true, subtree: true });\n})();\n\n\n// Modal fix for iframe circulars\n// This watches for when a modal is activated and makes the top margin of the modal equal to the distance\n// from the top of the page to the top of the circular-item. It then attempts to scroll the page down to that point.\ndocument.addEventListener('DOMContentLoaded', function() {\n\n\n  const circularsContainer = document.querySelector('.site-content');\n\n  const circular = document.querySelector('.circular');\n  const pages =  Number(circular.getAttribute('data-max-page-number'));\n  const circularHeight =  Number(circular.offsetHeight);\n  const estimatedHeight = circularHeight * (pages - 1);\n  circularsContainer.style.minHeight = `${Math.round(estimatedHeight)}px`;\n  console.log(`circularHeight: ${Math.round(circularHeight)}px`);\n  console.log(`estimatedHeight: ${Math.round(estimatedHeight)}px`);\n\n\n\n  circularsContainer.addEventListener('click', function(event) {\n    // Check if the clicked element or any of its parents has data-toggle=\"modal\"\n    const modalToggle = event.target.closest('[data-toggle=\"modal\"]');\n\n    if (modalToggle) {\n      const circularItem = modalToggle.closest('.circular-item');\n      const rect = circularItem.getBoundingClientRect();\n      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n      const distanceFromTop = rect.top + scrollTop;\n\n      // Send the information to the parent page\n      // window.parent.postMessage({\n      //   type: 'circularItemClicked',\n      //   distanceFromTop: Math.round(distanceFromTop)\n      // }, '*');\n      console.log(`Distance: ${Math.round(distanceFromTop)}px`);\n      const modalSelector = modalToggle.getAttribute('data-target');\n      const modal = document.querySelector(modalSelector);\n      modal.style.marginTop = `${distanceFromTop}px`;\n    }\n  });\n});\n\n"],"names":[],"mappings":"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"}